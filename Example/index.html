<!DOCTYPE html>
<html lang="en" class="no-js">
<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="manifest" href="manifest.json">
  <title>BMD Enterprise</title>
  <meta name="description" content="BMD Enterprise (An IBM Company)" />
  <meta name="author" content="Ananth" />


</head>
<body onload="myFunction();">
   <table>
      <tr>
        <td style= "width:30%;">
          <img class = "newappIcon" src="images/newapp-icon.png">
        <td>
            <h1>Hi there!</h1>
          <p>Thanks for creating a
            <span class = "blue">Bluemix Web Push example</span>.
    </table>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->

  <script>

  function myFunction() {

    (function(d, s, id){
      var js, sdkjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) {return;}
      js = d.createElement(s); js.id = id;
      js.src = "BMSPushSDK.js";
      sdkjs.parentNode.insertBefore(js, sdkjs);
    }(document, 'script', 'pushsdk'));

    window.sdkAsyncInit = function() {
      var res = new BMSPush(); //create an instance of BMSPush
      res.isDebugEnable(true) // for debugging
      function callback(response) {
        alert(response.response)
      }
      var params = {
        "appGUID":"push app GUID",
        "appRegion":"App Region"
        //"clientSecret":"Push Client Secret" (optional)
      }
      res.initialize(params, callback) // initialize Push Service
      //res.register("UserId", function(response) { // register device with userId in push service
      res.register(function(response) { // register device in push service
        alert(response.response)
        res.retrieveAvailableTags(function(response) { //Retrieve available tags
          alert(response.response)
          alert("here you go")
          var json = JSON.parse(response.response);
          var tagsA = []
          for (i in json.tags){
            tagsA.push(json.tags[i].name)
            alert(json.tags[i].name)
          }
          alert(tagsA)
          res.subscribe(tagsA,function(response) { // subscribe to available tags
              alert(response.response)
              tagsA.shift();
              res.unSubscribe(tagsA,function(response) { // unsubscribe from tags
                  alert(response.response)
                  res.unRegisterDevice(function(response) { // unregister device
                      alert(response.response)
                    })
                })
          })
        })
      })
    };
  }
  </script>

</body>
</html>
